<!DOCTYPE html>
<html>
<head>
    <title>Comprehensive Autocorrect Test</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px 20px;
            margin: 0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            font-size: 36px;
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .test-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }
        .test-input {
            width: 100%;
            padding: 12px 15px;
            font-size: 18px;
            border: 2px solid #ddd;
            border-radius: 8px;
            box-sizing: border-box;
            margin-bottom: 15px;
        }
        .test-input:focus {
            outline: none;
            border-color: #667eea;
        }
        .result-box {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.6;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .fail {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }
        button {
            width: 100%;
            padding: 12px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }
        button:hover {
            background: #5568d3;
        }
        .quick-tests {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }
        .quick-tests h2 {
            margin-top: 0;
            color: #333;
            font-size: 24px;
        }
        .test-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }
        .test-btn {
            padding: 10px;
            background: #764ba2;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        .test-btn:hover {
            background: #5f3d84;
            transform: translateY(-2px);
        }
        .log-console {
            background: #1e1e1e;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            padding: 20px;
            border-radius: 12px;
            margin-top: 30px;
            max-height: 500px;
            overflow-y: auto;
            font-size: 13px;
            line-height: 1.5;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }
        .stat {
            font-weight: bold;
            color: #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”¬ Comprehensive Autocorrect Test Suite</h1>
        
        <div class="quick-tests">
            <h2>âš¡ Quick Test Cases</h2>
            <div class="test-buttons">
                <button class="test-btn" onclick="runTest('damce')">damce â†’ dance</button>
                <button class="test-btn" onclick="runTest('phot')">phot â†’ photo*</button>
                <button class="test-btn" onclick="runTest('photy')">photy â†’ photo*</button>
                <button class="test-btn" onclick="runTest('photogapher')">photogapher</button>
                <button class="test-btn" onclick="runTest('dans')">dans â†’ dance</button>
                <button class="test-btn" onclick="runTest('weddig')">weddig â†’ wedding*</button>
                <button class="test-btn" onclick="runTest('cleanning')">cleanning</button>
                <button class="test-btn" onclick="runTest('plumer')">plumer â†’ plumbing</button>
                <button class="test-btn" onclick="runTest('elektrician')">elektrician</button>
                <button class="test-btn" onclick="runTest('makup')">makup â†’ makeup*</button>
                <button class="test-btn" onclick="runTest('yaga')">yaga â†’ yoga</button>
                <button class="test-btn" onclick="runTest('tutring')">tutring â†’ tutoring</button>
                <button class="test-btn" onclick="runTest('tatooo')">tatooo â†’ tattoo</button>
                <button class="test-btn" onclick="runTest('gardenr')">gardenr</button>
                <button class="test-btn" onclick="runTest('dj')">dj (exact)</button>
                <button class="test-btn" onclick="runTest('ac')">ac (exact)</button>
            </div>
            <p style="margin-top: 15px; color: #666; font-size: 13px;">* May match multiple services</p>
        </div>

        <div class="test-grid">
            <div class="test-card">
                <h3 style="margin-top: 0; color: #667eea;">ğŸ” Custom Test</h3>
                <input type="text" id="customInput" class="test-input" placeholder="Type a search term..." value="damce">
                <button onclick="runCustomTest()">Test This Query</button>
                <div id="customResult"></div>
            </div>

            <div class="test-card">
                <h3 style="margin-top: 0; color: #667eea;">ğŸ“Š Test Statistics</h3>
                <div id="stats" style="padding: 10px; background: #f8f9fa; border-radius: 6px; margin-top: 10px;">
                    <div>Total Tests: <span class="stat" id="totalTests">0</span></div>
                    <div style="margin-top: 8px;">Successful: <span class="stat" id="successCount" style="color: #28a745;">0</span></div>
                    <div style="margin-top: 8px;">Failed: <span class="stat" id="failCount" style="color: #dc3545;">0</span></div>
                    <div style="margin-top: 8px;">Success Rate: <span class="stat" id="successRate">0%</span></div>
                </div>
                <button onclick="runAllTests()" style="margin-top: 15px; background: #28a745;">Run All Tests</button>
                <button onclick="clearStats()" style="margin-top: 10px; background: #6c757d;">Clear Statistics</button>
            </div>
        </div>

        <div class="log-console" id="console">
            <div style="color: #00ffff; font-weight: bold;">â•â•â• AUTOCORRECT TEST CONSOLE â•â•â•</div>
            <div style="color: #ffff00; margin-top: 10px;">Ready to test. Click any test button to begin.</div>
        </div>
    </div>

    <script>
        // Exact copy of providerDatabase from services.js
        const providerDatabase = {
            'cleaning': [], 'plumbing': [], 'electrical': [], 'carpentry': [], 'painting': [],
            'beauty': [], 'tutoring': [], 'pest control': [], 'ac repair': [], 'babysitting': [],
            'moving': [], 'fitness': [], 'dance': [], 'dance teacher': [], 'dog sitting': [],
            'cat sitting': [], 'pet grooming': [], 'pet care': [], 'makeup artist': [],
            'hairstylist': [], 'hair salon': [], 'barber': [], 'massage': [], 'spa services': [],
            'personal trainer': [], 'yoga instructor': [], 'yoga': [], 'pilates': [],
            'meditation': [], 'concierge': [], 'personal chef': [], 'catering': [],
            'maid service': [], 'live-in maid': [], 'part-time maid': [], 'housekeeping': [],
            'nanny': [], 'manicure pedicure': [], 'nail technician': [], 'dietitian': [],
            'nutritionist': [], 'physiotherapy': [], 'photographer': [], 'photography': [],
            'videographer': [], 'wedding planner': [], 'event planner': [],
            'wedding decorator': [], 'event decorator': [], 'mehendi': [], 'tailor': [],
            'dj': [], 'music teacher': [], 'astrologer': [], 'pandit': [],
            'interior designer': [], 'gardener': [], 'car wash': [],
            'appliance repair': [], 'tattoo': []
        };

        let totalTests = 0, successCount = 0, failCount = 0;

        function log(message, color = '#00ff00') {
            const console = document.getElementById('console');
            const timestamp = new Date().toLocaleTimeString();
            console.innerHTML += `<div style="color: ${color};">[${timestamp}] ${message}</div>`;
            console.scrollTop = console.scrollHeight;
        }

        function clearLog() {
            document.getElementById('console').innerHTML = '<div style="color: #00ffff; font-weight: bold;">â•â•â• AUTOCORRECT TEST CONSOLE â•â•â•</div>';
        }

        // Exact copy of Levenshtein from services.js
        function calculateLevenshteinDistance(str1, str2) {
            const len1 = str1.length;
            const len2 = str2.length;
            const matrix = Array(len1 + 1).fill(null).map(() => Array(len2 + 1).fill(0));

            for (let i = 0; i <= len1; i++) matrix[i][0] = i;
            for (let j = 0; j <= len2; j++) matrix[0][j] = j;

            for (let i = 1; i <= len1; i++) {
                for (let j = 1; j <= len2; j++) {
                    const cost = str1[i - 1] === str2[j - 1] ? 0 : 1;
                    matrix[i][j] = Math.min(
                        matrix[i - 1][j] + 1,
                        matrix[i][j - 1] + 1,
                        matrix[i - 1][j - 1] + cost
                    );
                }
            }
            return matrix[len1][len2];
        }

        function calculateSimilarityPercentage(str1, str2) {
            const distance = calculateLevenshteinDistance(str1.toLowerCase(), str2.toLowerCase());
            const maxLen = Math.max(str1.length, str2.length);
            const similarityPercent = ((maxLen - distance) / maxLen) * 100;
            return Math.round(similarityPercent);
        }

        // NEW: Exact copy of enhanced findBestServiceMatch from services.js with substring/prefix boost
        function findBestServiceMatch(userQuery) {
            if (!userQuery || userQuery === 'all') {
                return { found: false, match: null, similarity: 0 };
            }

            const allServices = Object.keys(providerDatabase);
            let bestMatch = null;
            let bestSimilarity = 0;

            log(`ğŸ” Searching "${userQuery}" against ${allServices.length} services...`, '#00ffff');

            for (let service of allServices) {
                let similarity = calculateSimilarityPercentage(userQuery, service);
                
                // BOOST: substring match
                if (service.includes(userQuery)) {
                    const oldSim = similarity;
                    similarity = Math.min(100, similarity + 20);
                    log(`   âœ“ "${service}" contains "${userQuery}" â†’ ${oldSim}% + 20% = ${similarity}%`, '#ffff00');
                }
                
                // BOOST: prefix match
                if (service.startsWith(userQuery)) {
                    const oldSim = similarity;
                    similarity = Math.min(100, similarity + 30);
                    log(`   âœ“ "${service}" starts with "${userQuery}" â†’ ${oldSim}% - 20% + 30% = ${similarity}%`, '#ffaa00');
                }
                
                if (similarity > bestSimilarity) {
                    bestSimilarity = similarity;
                    bestMatch = service;
                }
                
                // Show high-scoring matches
                if (similarity >= 35 && similarity < bestSimilarity) {
                    log(`   â€¢ "${service}" â†’ ${similarity}%`, '#888');
                }
            }

            log(`âœ¨ BEST MATCH: "${bestMatch}" with ${bestSimilarity}%`, '#00ff00');
            log(`ğŸ¯ Threshold: 40% | Result: ${bestSimilarity >= 40 ? 'PASS âœ“' : 'FAIL âœ—'}`, bestSimilarity >= 40 ? '#00ff00' : '#ff0000');

            if (bestSimilarity >= 40) {
                return { found: true, match: bestMatch, similarity: bestSimilarity };
            }
            
            return { found: false, match: null, similarity: bestSimilarity };
        }

        function updateStats() {
            document.getElementById('totalTests').textContent = totalTests;
            document.getElementById('successCount').textContent = successCount;
            document.getElementById('failCount').textContent = failCount;
            const rate = totalTests > 0 ? Math.round((successCount / totalTests) * 100) : 0;
            document.getElementById('successRate').textContent = rate + '%';
        }

        function clearStats() {
            totalTests = 0;
            successCount = 0;
            failCount = 0;
            updateStats();
            clearLog();
            log('Statistics cleared. Ready for new tests.', '#ffff00');
        }

        function runTest(query) {
            clearLog();
            log(`â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•`, '#00ffff');
            log(`ğŸš€ TESTING: "${query}"`, '#00ffff');
            log(`â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•`, '#00ffff');
            
            const result = findBestServiceMatch(query);
            
            totalTests++;
            
            const resultDiv = document.createElement('div');
            if (result.found) {
                successCount++;
                log(``, '#00ff00');
                log(`âœ… SUCCESS! Autocorrect would trigger:`, '#00ff00');
                log(`   User typed: "${query}"`, '#ffffff');
                log(`   Corrected to: "${result.match}"`, '#00ff00');
                log(`   Similarity: ${result.similarity}%`, '#00ff00');
                log(``, '#00ff00');
                log(`ğŸ“„ On services.html, user would see:`, '#ffff00');
                log(`   "Showing results for ${result.match} instead of ${query}"`, '#ffaa00');
            } else {
                failCount++;
                log(``, '#ff0000');
                log(`âŒ FAILED! No match found (below 40% threshold)`, '#ff0000');
                log(`   Best guess: "${result.match || 'none'}"`, '#ff6666');
                log(`   Similarity: ${result.similarity}%`, '#ff6666');
                log(`   Needed: 40% minimum`, '#ff6666');
            }
            
            updateStats();
        }

        function runCustomTest() {
            const input = document.getElementById('customInput').value.trim().toLowerCase();
            const resultDiv = document.getElementById('customResult');
            
            if (!input) {
                resultDiv.innerHTML = '<div class="result-box fail">Please enter a search term</div>';
                return;
            }

            clearLog();
            log(`â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•`, '#00ffff');
            log(`ğŸ”¬ CUSTOM TEST: "${input}"`, '#00ffff');
            log(`â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•`, '#00ffff');
            
            const result = findBestServiceMatch(input);
            
            totalTests++;
            
            if (result.found && result.match !== input) {
                successCount++;
                resultDiv.innerHTML = `
                    <div class="result-box success">
                        <strong>âœ… AUTOCORRECT WORKS!</strong><br><br>
                        <strong>You typed:</strong> ${input}<br>
                        <strong>Corrected to:</strong> ${result.match}<br>
                        <strong>Similarity:</strong> ${result.similarity}%<br>
                        <strong>Above threshold:</strong> YES (40%)
                    </div>
                `;
                log(`âœ… Custom test PASSED!`, '#00ff00');
            } else if (!result.found) {
                failCount++;
                resultDiv.innerHTML = `
                    <div class="result-box fail">
                        <strong>âŒ NO MATCH FOUND</strong><br><br>
                        <strong>You typed:</strong> ${input}<br>
                        <strong>Best guess:</strong> ${result.match || 'none'}<br>
                        <strong>Similarity:</strong> ${result.similarity}%<br>
                        <strong>Below threshold:</strong> YES (need 40%)
                    </div>
                `;
                log(`âŒ Custom test FAILED - below threshold`, '#ff0000');
            } else {
                resultDiv.innerHTML = `
                    <div class="result-box info">
                        <strong>â„¹ï¸ EXACT/CLOSE MATCH</strong><br><br>
                        <strong>You typed:</strong> ${input}<br>
                        <strong>Match:</strong> ${result.match}<br>
                        <strong>Similarity:</strong> ${result.similarity}%<br>
                        <strong>No correction needed</strong>
                    </div>
                `;
                log(`â„¹ï¸ Input matches existing service`, '#00ffff');
            }
            
            updateStats();
        }

        function runAllTests() {
            clearLog();
            const tests = ['damce', 'phot', 'photy', 'photogapher', 'dans', 'weddig', 'cleanning', 'plumer', 'elektrician', 'makup', 'yaga', 'tutring', 'tatooo', 'gardenr'];
            
            log(`â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—`, '#00ffff');
            log(`â•‘   RUNNING ${tests.length} AUTOMATED TESTS          â•‘`, '#00ffff');
            log(`â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•`, '#00ffff');
            log(``);
            
            tests.forEach((test, index) => {
                log(`â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€`, '#666');
                log(`Test ${index + 1}/${tests.length}: "${test}"`, '#ffff00');
                const result = findBestServiceMatch(test);
                totalTests++;
                
                if (result.found) {
                    successCount++;
                    log(`âœ… PASS â†’ "${result.match}" (${result.similarity}%)`, '#00ff00');
                } else {
                    failCount++;
                    log(`âŒ FAIL â†’ No match (${result.similarity}%)`, '#ff0000');
                }
                log(``);
            });
            
            log(`â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—`, '#00ffff');
            log(`â•‘         TEST SUITE COMPLETE           â•‘`, '#00ffff');
            log(`â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•`, '#00ffff');
            log(`Results: ${successCount}/${totalTests} passed (${Math.round((successCount/totalTests)*100)}%)`, '#ffff00');
            
            updateStats();
        }

        // Initialize
        window.onload = () => {
            log(`âœ… Test suite loaded successfully`, '#00ff00');
            log(`ğŸ“¦ Database: ${Object.keys(providerDatabase).length} services available`, '#00ff00');
            log(`ğŸ¯ Threshold: 40% similarity required`, '#00ff00');
            log(`âœ¨ Boosters: +20% substring, +30% prefix`, '#00ff00');
            log(``, '#00ff00');
            log(`Type in the custom test box or click quick test buttons to begin.`, '#ffff00');
        };
    </script>
</body>
</html>
